apiVersion: certmanager.k8s.io/v1alpha1
kind: Certificate
metadata:
  name: preferences-cert
  namespace: gpii
spec:
  secretName: preferences-tls
  issuerRef:
    <% if ENV["TF_VAR_cluster_name"].start_with?("prd.") %>
    name: letsencrypt-production
    <% else %>
    name: letsencrypt-staging
    <% end %>
  dnsNames:
  - preferences.<%= ENV["TF_VAR_environment"] %>.gpii.net
  acme:
    config:
    - http01:
        ingressClass: nginx
      domains:
      - preferences.<%= ENV["TF_VAR_environment"] %>.gpii.net
